<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>	
	<title>wForms 3.0 - Repeat Behavior Test Suite</title>
	<meta name="Description" content="wForms is an open-source, unobtrusive javascript library that adds commonly needed behaviors to traditional web forms without the need for any programming skills." />
	<meta http-equiv="Keywords" content="form, web form, html form, online form, wForms, input validation, field validation, javascript library" />
	
	<script type="text/javascript" src="jsunit/app/jsUnitCore.js"></script>
	
	<link href="../css/wforms-jsonly.css" type="text/css" rel="stylesheet" />
    <link href="../css/wforms-layout.css" type="text/css" rel="stylesheet" />

	<script type="text/javascript" src="../lib/base2/beta2/src/base2.js"></script>
	<script type="text/javascript" src="../lib/base2/beta2/src/base2-dom.js"></script>
	<script type="text/javascript" src="../wforms_core.js"></script>
	<script type="text/javascript" src="../wforms_repeat.js"></script>	
	<script type="text/javascript" src="../wforms_hint.js"></script>	
	<script type="text/javascript" src="../wforms_validation.js"></script>	
   
	<script type="text/javascript">
		wFORMS.behaviors.repeat.onRepeat = function(n) {
			var form = document.getElementById('testRepeatForm');
			var f=form.getElementsByTagName('input');
			for(var i=0;i<f.length;i++) {
				if(f[i].id && f[i].id.indexOf(wFORMS.behaviors.repeat.ID_SUFFIX_COUNTER)==-1) {
					f[i].value='id='+f[i].id;
				}
			}
		}
	</script>
	
	<script type="text/javascript">
	
	wFORMS.behaviors.repeat.instance.prototype.onApply = function() {
		setUpPageStatus = 'complete';
	} 
	
	function setUpPage() {}
  
  	function setUp() {  }
	
	function tearDown() {}
	
	function testFieldsetRepeatWithFieldHints() {
		var fieldHint = document.getElementById('testInput0-H');
		var placeholder = document.getElementById('testInput0-E');
		
		var bInstance = wFORMS.getBehaviorInstance(document.getElementsByTagName('DIV')[1], 'repeat');		
		bInstance.run();
		
		// Check  field hint
		assertEquals('testInput0[0][0]-H',fieldHint.id);
		assertNotNull(document.getElementById('testInput0[0][1]-H'));
		
		// Check placeholder for validation behavior 
		assertEquals('testInput0[0][0]-E', placeholder.id);
		assertNotNull('Error Placeholder Id should be properly constructed', document.getElementById('testInput0[0][1]-E'));
		
		var bInstance = wFORMS.getBehaviorInstance(document.getElementsByTagName('DIV')[0], 'repeat');		
		bInstance.run();
		
		assertEquals('testInput0[0][0]-H',fieldHint.id);
		assertNotNull(document.getElementById('testInput0[1][0]-H'));
		assertNotNull(document.getElementById('testInput0[0][1]-H'));
		assertNotNull(document.getElementById('testInput0[0][0]-H'));
		
		assertNotNull('Error Placeholder with id testInput0[1][0]-E should exists', document.getElementById('testInput0[1][0]-E'));
	}
	
	</script>
	
</head>

<body class="wForm">
	<h2>Repeat Behavior Test Suite</h2>

	<form method="post" action="http://app.formassembly.com/responses/testprocessor" id="testRepeatForm" style="width: 550px">
		<div class="repeat" id="test0">
			<div class="oneField repeat" id="test1">
				<label for="testInput0" class="preField" style="min-width:5em">Date</label>
				<input type="text" id="testInput0" name="testInput0" value="" size="" />
				<div class="field-hint-inactive" id="testInput0-H">
					<span>JJ/MM/AAAA </span>
				</div>					
				<div id="testInput0-E" class="errMsg">error placeholder</div>
			</div>
		</div>	
		<a href="#" onclick="testFieldsetRepeatWithErrorPlaceholders(); return false;">Test</a>
	</form>
</body>
</html>


